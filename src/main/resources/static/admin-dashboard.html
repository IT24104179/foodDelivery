<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ByteEats • Admin – Customers</title>
    <link rel="stylesheet" href="style.css" />
    <style>
        body            { font-family: Arial, sans-serif; margin: 30px; }
        h2              { margin-bottom: 5px; }
        #topBar         { display:flex; justify-content: space-between; align-items:center; margin:12px 0; }
        #search         { padding:6px 8px; width:250px; }
        table           { width:100%; border-collapse:collapse; margin-top:8px; }
        th,td           { padding:8px 10px; border:1px solid #bbb; word-wrap: anywhere; }
        th.sticky       { position:sticky; top:0; background:#f3f3f3; }
        tr:nth-child(even){ background:#fafafa; }
        #count          { font-weight:bold; }
    </style>
</head>
<body>
<h2>Registered Customers</h2>

<div id="topBar">
    <span>Total: <span id="count">0</span></span>
    <input id="search" placeholder="Search by name / email…" />
</div>

<table id="tbl">
    <thead>
    <tr>
        <th class="sticky">ID</th>
        <th class="sticky">Username</th>
        <th class="sticky">Email</th>
        <th class="sticky">Address</th>
        <th class="sticky">Phone</th>
    </tr>
    </thead>
    <tbody></tbody>
</table>

<script>
    let allRows = [];   // keep original list for filtering

    async function loadCustomers() {
      const res  = await fetch("/api/users/customers");
      allRows    = await res.json();
      renderTable(allRows);
    }
    function renderTable(list){
      const tb   = document.querySelector("#tbl tbody");
      tb.innerHTML = "";
      list.forEach(u=>{
        tb.innerHTML += `<tr>
          <td>${u.id}</td><td>${u.username}</td><td>${u.email}</td>
          <td>${u.address}</td><td>${u.phoneNumber}</td>
        </tr>`;
      });
      document.getElementById("count").textContent = list.length;
    }
    /* live search ----------------------------------------------------- */
    document.getElementById("search").addEventListener("input", e=>{
      const q = e.target.value.toLowerCase();
      const filtered = allRows.filter(r =>
          r.username.toLowerCase().includes(q) ||
          r.email   .toLowerCase().includes(q)
      );
      renderTable(filtered);
    });
    loadCustomers();
</script>
</body>
</html>
